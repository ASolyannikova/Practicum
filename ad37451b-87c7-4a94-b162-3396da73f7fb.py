#!/usr/bin/env python
# coding: utf-8

# <div class="alert alert-info">
# –ü—Ä–∏–≤–µ—Ç, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞! –ú–µ–Ω—è –∑–æ–≤—É—Ç –°–≤–µ—Ç–ª–∞–Ω–∞ –ß–∏—Ö –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ.
# 
# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ó–µ–ª—ë–Ω—ã–º —Ü–≤–µ—Ç–æ–º –æ—Ç–º–µ—á–µ–Ω—ã —É–¥–∞—á–Ω—ã–µ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.
# </div>
# <div class="alert alert-warning">
# <b>ü§î –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> –ñ—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω–æ —Ç–æ, —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É. –¢—ã –º–æ–∂–µ—à—å —É—á–µ—Å—Ç—å —ç—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å (–æ–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
# </div>
# <div class="alert alert-danger">
# <b>üòî –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:</b> –ö—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö, —è –Ω–µ —Å–º–æ–≥—É –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç :(
# </div>
# <div class="alert alert-info">
# <b>üëÇ –°–æ–≤–µ—Ç:</b> –ö–∞–∫–∏–µ-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
# </div>
# –î–∞–≤–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º.
# –ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –≤—ã–¥–µ–ª–∏—à—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
# <div class="alert alert-info"> <b>üéì –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫.</div>
# –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã—Å—Ç—Ä–µ–µ.
#  </div>

# <h1>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<span class="tocSkip"></span></h1>
# <div class="toc"><ul class="toc-item"><li><span><a href="#–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:" data-toc-modified-id="–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:-1">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:</a></span></li><li><span><a href="#–û–ø–∏—Å–∞–Ω–∏–µ-–∏-–∑–∞–¥–∞—á–∏-–ø—Ä–æ–µ–∫—Ç–∞" data-toc-modified-id="–û–ø–∏—Å–∞–Ω–∏–µ-–∏-–∑–∞–¥–∞—á–∏-–ø—Ä–æ–µ–∫—Ç–∞-2">–û–ø–∏—Å–∞–Ω–∏–µ –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞</a></span></li><li><span><a href="#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö" data-toc-modified-id="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-3">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></span></li><li><span><a href="#–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑-–¥–∞–Ω–Ω—ã—Ö" data-toc-modified-id="–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑-–¥–∞–Ω–Ω—ã—Ö-4">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö</a></span><ul class="toc-item"><li><span><a href="#–°—Ä–µ–¥–Ω–∏–π-—á–µ–∫,-–≤—ã—Ä—É—á–∫–∞-–∏-–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ-—Ç–æ–≤–∞—Ä–æ–≤-–≤-–∫–∞–∂–¥–æ–π-–∫–∞—Ç–µ–≥–æ—Ä–∏–∏" data-toc-modified-id="–°—Ä–µ–¥–Ω–∏–π-—á–µ–∫,-–≤—ã—Ä—É—á–∫–∞-–∏-–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ-—Ç–æ–≤–∞—Ä–æ–≤-–≤-–∫–∞–∂–¥–æ–π-–∫–∞—Ç–µ–≥–æ—Ä–∏–∏-4.1">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫, –≤—ã—Ä—É—á–∫–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</a></span></li><li><span><a href="#–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å-–≤-–∑–∞–∫–∞–∑–∞—Ö" data-toc-modified-id="–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å-–≤-–∑–∞–∫–∞–∑–∞—Ö-4.2">–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–∫–∞–∑–∞—Ö</a></span></li><li><span><a href="#–†–æ–∑–Ω–∏—á–Ω—ã–µ-–∏-–æ–ø—Ç–æ–≤—ã–µ-–ø–æ–∫—É–ø–∞—Ç–µ–ª–∏" data-toc-modified-id="–†–æ–∑–Ω–∏—á–Ω—ã–µ-–∏-–æ–ø—Ç–æ–≤—ã–µ-–ø–æ–∫—É–ø–∞—Ç–µ–ª–∏-4.3">–†–æ–∑–Ω–∏—á–Ω—ã–µ –∏ –æ–ø—Ç–æ–≤—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏</a></span></li><li><span><a href="#–°—Ä–µ–¥–Ω–∏–π-—á–µ–∫,-–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ-–∑–∞–∫–∞–∑–æ–≤-–∏-–≤—ã—Ä—É—á–∫–∞-—É-—Ä–æ–∑–Ω–∏—á–Ω—ã—Ö-–ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π" data-toc-modified-id="–°—Ä–µ–¥–Ω–∏–π-—á–µ–∫,-–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ-–∑–∞–∫–∞–∑–æ–≤-–∏-–≤—ã—Ä—É—á–∫–∞-—É-—Ä–æ–∑–Ω–∏—á–Ω—ã—Ö-–ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π-4.4">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –≤—ã—Ä—É—á–∫–∞ —É —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</a></span></li><li><span><a href="#–¢–æ–ø–æ–≤—ã–µ-–ø–æ–∑–∏—Ü–∏–∏-–≤-—Å–∞–º—ã—Ö-–ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö-–∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö-(–æ—Å–Ω–æ–≤–Ω–æ–π-–∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç)" data-toc-modified-id="–¢–æ–ø–æ–≤—ã–µ-–ø–æ–∑–∏—Ü–∏–∏-–≤-—Å–∞–º—ã—Ö-–ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö-–∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö-(–æ—Å–Ω–æ–≤–Ω–æ–π-–∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç)-4.5">–¢–æ–ø–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ —Å–∞–º—ã—Ö –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö (–æ—Å–Ω–æ–≤–Ω–æ–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç)</a></span></li></ul></li><li><span><a href="#–†–∞–±–æ—Ç–∞-—Å-–≤—ã–±—Ä–æ—Å–∞–º–∏" data-toc-modified-id="–†–∞–±–æ—Ç–∞-—Å-–≤—ã–±—Ä–æ—Å–∞–º–∏-5">–†–∞–±–æ—Ç–∞ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏</a></span></li><li><span><a href="#–ü—Ä–æ–≤–µ—Ä–∫–∞-–≥–∏–ø–æ—Ç–µ–∑" data-toc-modified-id="–ü—Ä–æ–≤–µ—Ä–∫–∞-–≥–∏–ø–æ—Ç–µ–∑-6">–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑</a></span><ul class="toc-item"><li><span><a href="#–°—Ä–µ–¥–Ω—è—è-–≤—ã—Ä—É—á–∫–∞-–ø–æ-—Ä–æ–∑–Ω–∏—á–Ω—ã–º-–∏-–æ–ø—Ç–æ–≤—ã–º-–ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º-—Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è" data-toc-modified-id="–°—Ä–µ–¥–Ω—è—è-–≤—ã—Ä—É—á–∫–∞-–ø–æ-—Ä–æ–∑–Ω–∏—á–Ω—ã–º-–∏-–æ–ø—Ç–æ–≤—ã–º-–ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º-—Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è-6.1">–°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ –ø–æ —Ä–æ–∑–Ω–∏—á–Ω—ã–º –∏ –æ–ø—Ç–æ–≤—ã–º –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è</a></span></li></ul></li><li><span><a href="#–í—ã–≤–æ–¥" data-toc-modified-id="–í—ã–≤–æ–¥-7">–í—ã–≤–æ–¥</a></span></li></ul></div>

# # –ê–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–Ω–æ–≥–æ –∞—Å—Å–æ—Ä—Ç–º–µ–Ω—Ç–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞ –∏ –±—ã—Ç–∞ ¬´–ü–æ–∫–∞ –≤—Å–µ –µ—â—ë —Ç—É—Ç¬ª

# ## –ú–∞—Ç–µ—Ä–∏–∞–ª—ã:
# * [–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è](https://drive.google.com/file/d/1ZF_W8cF489a07lLsLu7njr9kmSz2pX78/view?usp=sharing)
# * [–î–∞—à–±–æ—Ä–¥](https://public.tableau.com/app/profile/.21317407/viz/_16627155634340/Dashboard1?publish=yes)
# 

# ## –û–ø–∏—Å–∞–Ω–∏–µ –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞

# **–û–ø–∏—Å–∞–Ω–∏–µ**:
# 
# –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞ ¬´–ü–æ–∫–∞ –≤—Å–µ –µ—â—ë —Ç—É—Ç¬ª –≤ —Å—Ä–æ—á–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∏—â–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤. –í—ã –ø–æ–º–æ–∂–µ—Ç–µ –Ω–∞—à–µ–º—É –º–∞–≥–∞–∑–∏–Ω—É —Å—Ç–∞—Ç—å –ª—É—á—à–µ, –∞ –∫–ª–∏–µ–Ω—Ç–∞–º ‚Äî –æ–±—É—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º —Å–≤–æ–µ–π –º–µ—á—Ç—ã. –ù–∞—à–∞ –±–ª–∏–∂–∞–π—à–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–Ω–æ–≥–æ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞.
# 
# **–ó–∞–¥–∞—á–∞**:
# –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã —è–≤–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ (—á—Ç–æ –ø–æ–∫—É–ø–∞—é—Ç —á–∞—â–µ), –∞ –∫–∞–∫–∏–µ - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ (–ø–æ–∫—É–ø–∞—é—Ç —Ä–µ–¥–∫–æ –∏–ª–∏ –≤–∫—É–ø–µ —Å –∫–∞–∫–∏–º-—Ç–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Ç–æ–≤–∞—Ä–æ–º);
#  
# 
#  

# ## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# In[1]:


#–∏–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
import pandas as pd
import datetime
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
import numpy as np
from scipy import stats as st
from io import BytesIO
import requests
spreadsheet_id = '11yhh15P5Rt4lLULJl8AAMtTrAIiYjEE4JNAxczF3KWk'
file_name = 'https://docs.google.com/spreadsheets/d/{}/export?format=csv'.format(spreadsheet_id)
r = requests.get(file_name)
df = pd.read_csv(BytesIO(r.content))
df


# In[2]:


#—Å–º–æ—Ç—Ä–∏–º –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
df.info()


# –î–∞—Ç–∞—Å–µ—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 6 —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ 6737 —Å—Ç—Ä–æ–∫. –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ—Ç. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Ü–µ–ª–æ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –Ω–æ –Ω—É–∂–Ω–æ –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞—Ç–æ–π

# In[3]:


#–ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ df:', df.duplicated().sum())


# In[4]:


#—É–±–∏—Ä–µ–º —Å—Ç–æ–ª–±–µ—Ü —Å –¥–∞—Ç–æ–π –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –¥—É–±–ª–∏–∫–∞—Ç—ã –µ—â–µ —Ä–∞–∑
df_without_date = df.drop(['date'], axis = 1)
df_without_date


# In[5]:


print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ df_without_date:', df_without_date.duplicated().sum())


# In[6]:


#—É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
df_without_date = df_without_date.drop_duplicates()


# In[7]:


df_without_date.info()


# In[8]:


#–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–º –æ–±—Ä–∞—Ç–Ω–æ –¥–∞—Ç—É
dt = df_without_date.merge(df, right_index=True, left_index=True)
dt


# In[9]:


#—É–±–µ—Ä–µ–º –ª–∏—à–Ω–∏–µ —Å—Ç–æ–ª–±—Ü—ã –∏ –≤–µ—Ä–Ω–µ–º –ø—Ä–∏–≤—ã—á–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
dt_new = dt.drop(['customer_id_y', 'order_id_y', 'product_y', 'quantity_y', 'price_y'], axis=1)
dt_new.rename(columns={'customer_id_x': 'customer_id', 'order_id_x': 'order_id', 'product_x': 'product', 'quantity_x': 'quantity', 'price_x': 'price'}, inplace = True)
dt_new


# In[10]:


#–≤ —Å—Ç–æ–ª–±—Ü–µ product –æ—Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —Å–ª–æ–≤–∞, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã

dt_new['product'] = dt_new['product'].str.split().str[0:2]


# In[11]:


dt_new


# –¢–∞–∫–∂–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–≤–µ–¥–µ–º —Å—Ç–æ–ª–±–µ—Ü —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π —Ç–æ–≤–∞—Ä–∞

# –ü—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –∏ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫.
# 
# 
# –¢–∞–∫ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ, –ø—Ä–∏—á–∏–Ω—É —è –Ω–µ –Ω–∞—à–ª–∞.
# 
# –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

# <div class="alert alert-warning">
# <b>ü§î –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> 'product' –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å—Ç–æ–±–ª—Ü–æ–º –Ω–∏ –≤ –æ–¥–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ, –ø–æ—ç—Ç–æ–º—É –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ—á–∫—É –≤ –ª–µ–≤–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –±—ã–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω—ã –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å —Ç–∞–∫–∏–º –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ –ø—Ä–∞–≤–æ–º
# </div>

# In[12]:


sht_id = '18R5tk1IQtDAFX2-X2zDIQfkCmz7dngrFGwwvg1wcyy4'
file1 = 'https://docs.google.com/spreadsheets/d/{}/export?format=csv'.format(sht_id)
r = requests.get(file1)
df_new = pd.read_csv(BytesIO(r.content))
df_new


# In[13]:


#–ø–æ—Å–º–æ—Ç—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –ø—Ä–æ–¥—É–∫—Ç

df_new['product'].value_counts().head(30)


# –í–∏–¥–Ω–æ, —á—Ç–æ –µ—Å—Ç—å —Ç–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É –≤–∏–¥—É, –Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –ø–æ —Ä–∞–∑–Ω–æ–º—É : —Ä–∞—Å—Å–∞–¥–∞, –ø–µ–ª–∞—Ä–≥–æ–Ω–∏—è –∏ —Ç.–¥.
# 
# –ó–∞–º–µ–Ω–∏–º —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –µ–¥–∏–Ω—ã–µ

# In[14]:


df_new['product'] = df_new['product'].replace(['–†–∞—Å—Å–∞–¥–∞ –ö–∞–±–∞—á–∫–∞', '–†–∞—Å—Å–∞–¥–∞ –∑–µ–ª–µ–Ω–∏', '–†–∞—Å—Å–∞–¥–∞ –û–≥—É—Ä–µ—Ü', '–†–∞—Å—Å–∞–¥–∞ –ü–∞—Ç–∏—Å—Å–æ–Ω–∞', '–†–∞—Å—Å–∞–¥–∞ –û–≥—É—Ä—Ü–∞', '–†–∞—Å—Å–∞–¥–∞ –ö–∞–ø—É—Å—Ç—ã', '–†–∞—Å—Å–∞–¥–∞ –ê—Ä–±—É–∑–∞', '–†–∞—Å—Å–∞–¥–∞ –î—ã–Ω–∏', '–†–∞—Å—Å–∞–¥–∞ —Ç–æ–º–∞—Ç–∞', '–†–∞—Å—Å–∞–¥–∞ –ø—Ä—è–Ω–æ–π'], '–†–∞—Å—Å–∞–¥–∞')
df_new['product'] = df_new['product'].replace(['–ü–µ–ª–∞—Ä–≥–æ–Ω–∏—è –∑–æ–Ω–∞–ª—å–Ω–∞—è', '–ü–µ–ª–∞—Ä–≥–æ–Ω–∏—è —Ä–æ–∑–µ–±—É–¥–Ω–∞—è', '–ü–µ–ª–∞—Ä–≥–æ–Ω–∏—è Toscana'], '–ü–µ–ª–∞—Ä–≥–æ–Ω–∏—è')
df_new['product'] = df_new['product'].replace('–°—É—à–∏–ª–∫–∞ –¥–ª—è', '–°—É—à–∏–ª–∫–∞')
df_new['product'] = df_new['product'].replace(['–°—É–º–∫–∞-—Ç–µ–ª–µ–∂–∫–∞ 2-—Ö', '–°—É–º–∫–∞-—Ç–µ–ª–µ–∂–∫–∞ —Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–∞—è'], '–°—É–º–∫–∞-—Ç–µ–ª–µ–∂–∫–∞')
df_new['product'] = df_new['product'].replace('—Ç–æ–º–∞—Ç–∞ (–ø–æ–º–∏–¥–æ—Ä)', '–¢–æ–º–∞—Ç')


# In[15]:


df_new['product'].value_counts().head(30)


# –°–æ–∑–¥–∞–¥–∏–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å —Å—É–º–º–æ–π –∑–∞—Ç—Ä–∞—Ç. –ß—Ç–æ–±—ã –ø–æ —Ç–µ–º —Ç–æ–≤–∞—Ä–∞–º, –≥–¥–µ –∫–æ–ª-–≤–æ –±–æ–ª—å—à–µ 1, –±—ã–ª–∞ –≤–∏–¥–Ω–∞ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ –≤–µ—Å—å –æ–±—ä–µ–º.

# In[16]:


df_new['total'] = df_new['quantity'] * df_new['price']


# In[17]:


df_new


# –ë—ã–ª–æ –≤–µ–¥–µ–ª–µ–Ω–æ 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤

# In[18]:


df_new['category'].unique()


# In[19]:


#–ø–µ—Ä–µ–≤–µ–ª–∏ —Å—Ç–æ–ª–±tw —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
df_new['date_new'] = pd.to_datetime(df_new['date_new'])


# In[20]:


df_new.info()


# **–ò—Ç–æ–≥ –ø–æ —Ä–∞–∑–¥–µ–ª—É:**
#   - –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ —è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –±–µ–∑ —É—á–µ—Ç–∞ —Å—Ç–æ–ª–±—Ü–∞ —Å –¥–∞—Ç–æ–π: –Ω–∞—à–ª–∏ 1864 –¥—É–±–ª–∏–∫–∞—Ç–∞ (~28% –æ—Ç –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö) –∏ —É–¥–∞–ª–∏–ª–∏ –∏—Ö 
#   - –∑–∞–º–µ–Ω–∏–ª–∏ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –Ω–µ–≤—è–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–∞ –µ–¥–∏–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —É–¥–∞–ª–∏–≤ –ª–∏—à–Ω–∏–µ —Å–ª–æ–≤–∞
#   - –ø—Ä–æ—Å—Ç–∞–≤–∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
#   - –≤—ã–¥–µ–ª–∏–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≥–æ–¥, –º–µ—Å—è—Ü, –¥–µ–Ω—å –∏ —á–∞—Å –ø–æ–∫—É–ø–∫–∏
#   - –ø–æ—Å—á–∏—Ç–∞–ª–∏ —Å—É–º–º—É –∑–∞—Ç—Ä–∞—Ç –ø–æ —Ç–æ–≤–∞—Ä–∞–º
#   

# ## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# ### –°—Ä–µ–¥–Ω–∏–π —á–µ–∫, –≤—ã—Ä—É—á–∫–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

# In[21]:


#–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π

groups = df_new.groupby('category')['quantity'].sum().sort_values()
groups


# In[22]:


#—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(10,7))
groups.plot(kind = 'barh')
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show();


# –Ø–≤–Ω—ã–π –ª–∏–¥–µ—Ä —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π - —ç—Ç–æ —Ü–≤–µ—Ç—ã –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è.
# 
# –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫.

# In[23]:


#–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫

chek = df_new.groupby('category')['total'].mean().sort_values()
chek


# In[24]:


#—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(10,7))
chek.plot(kind = 'barh')
plt.title('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏')
plt.xlabel('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show();


# –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –æ–∫–∞–∑–∞–ª—Å—è –±–æ–ª—å—à–∏–º –≤ –¥—Ä–≥—É–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö:
#   - —Ç–µ–∫—Å—Ç–∏–ª—å 2000 —Ä—É–±
#   - —Ö–æ–∑ —Ç–æ–≤–∞—Ä—ã 1800 —Ä—É–±
#   - —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏ —Ä–µ–º–æ–Ω—Ç 1770 —Ä—É–±

# –ü–æ—Å–º–æ—Ç—Ä–∏–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Ä—É—á–∫—É –ø–æ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
# 

# In[25]:


revenue = df_new.groupby('category')['total'].sum().sort_values()
revenue


# In[26]:


#—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(10,7))
revenue.plot(kind = 'barh')
plt.title('–í—ã—Ä—É—á–∫–∞ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏')
plt.xlabel('–í—ã—Ä—É—á–∫–∞')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show();


# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–≤–µ–¥–µ–º –∫—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É —Å –¥–æ–ª–µ–π –≤—ã—Ä—É—á–∫–∏ –ø–æ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

# In[27]:


revenue1 = revenue.reset_index().sort_values(by = 'total', ascending =  False)

fig, ax = plt.subplots(figsize=(10,10))
ax.pie(revenue1['total'], labels=revenue1['category'], autopct='%1.1f%%');
ax.set_title('–î–æ–ª—è –≤—ã—Ä—É—á–∫–∏ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');


# **–ò—Ç–æ–≥ –ø–æ —Ä–∞–∑–¥–µ–ª—É:**
#   - –ë–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–•–æ–∑ —Ç–æ–≤–∞—Ä—ã" (59%). –í —ç—Ç–æ–π –∂–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ (1800 —Ä—É–±). –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ö–æ–∑ —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (~3700 —à—Ç).
#   
#   
#   - –°–∞–º–æ–π –ø–æ–ø—É–ª—è—Ä–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª —Å —Ü–≤–µ—Ç–∞–º–∏ –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è–º–∏: –±—ã–ª–æ –ø—Ä–æ–¥–∞–Ω–æ ~4 —Ç—ã—Å —Ç–æ–≤–∞—Ä–æ–≤. –ù–∞ –¥–∞–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è 12,8% –æ—Ç –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏. –°—Ä —á–µ–∫ —Å–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π: 210 —Ä—É–±. –ü–æ–∫—É–ø–∞—é—Ç –º–Ω–æ–≥–æ –¥–µ—à–µ–≤–æ–π —Ä–∞—Å—Å–∞–¥—ã, —Å–µ–º—è–Ω –∏ –¥–æ–º–∞—à–Ω–∏—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π
#   
#   
#   - –°–∞–º—ã–π –±–æ–ª—å—à–æ–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ —É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–¢–µ–∫—Å—Ç–∏–ª—å" - 2082 —Ä—É–±. –û–¥–Ω–∞–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ–¥–∞–Ω–æ –º–∞–ª–æ: 270 —à—Ç. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –æ–¥–Ω–∏ –∏–∑ —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ –º–∞–≥–∞–∑–∏–Ω–µ.
#   
# 

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã, –æ—á–µ–Ω—å —É–¥–∞—á–Ω–æ –≤—ã–±—Ä–∞–Ω–∞ –∫—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞, —Å—Ä–∞–∑—É –≤–∏–¥–Ω–æ –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 
# </div>

# ### –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–∫–∞–∑–∞—Ö

# –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≥–æ–¥–∞.

# In[28]:


fig, ax = plt.subplots(figsize=(10, 6))
ax.scatter(x = df_new['month'], y = df_new['quantity'])
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º')
plt.xlabel("–ú–µ—Å—è—Ü")
plt.ylabel("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ")

plt.show()


# –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ —Å—Ä–∞–∑—É –≤–∏–¥–Ω—ã –≤—ã–±—Ä–æ—Å—ã: –±—ã–ª–∏ –∑–∞–∫–∞–∑—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞ —Ä–∞–∑ –∫–ª–∏–µ–Ω—Ç—ã –±—Ä–∞–ª–∏ –±–æ–ª—å—à–µ 200 –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞. 
# –î–∞–∂–µ –µ—Å—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ 1000 —à—Ç—É–∫.
# –ò–∑-–∑–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ, –µ—Å—Ç—å –ª–∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å
# 
# –í —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —ç—Ç–æ –¥–µ—Ç–∞–ª—å–Ω–µ–µ

# ### –†–æ–∑–Ω–∏—á–Ω—ã–µ –∏ –æ–ø—Ç–æ–≤—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏

# –û—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–æ–π —á–µ—Ä—Ç–æ–π –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —è–≤–ª—è–µ—Ç—Å—è –æ–±—ä–µ–º –∑–∞–∫–∞–∑–æ–≤: –æ–Ω–∏ –±–µ—Ä—É—Ç —Å—Ä–∞–∑—É –º–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞.
# 
# –ß—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å —Å—Ä–µ–¥–∏ –Ω–∞—à–∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –æ–ø—Ç–æ–≤–∏–∫–æ–≤ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∫–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–∫–∞–∑–µ

# In[29]:


order = df_new.groupby('order_id')['quantity'].sum().reset_index().sort_values(by = 'quantity',  ascending = False)
order.head(20)


# In[30]:


print('–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —Å—Ç–æ–ª–±—Ü—É quantity:',order['quantity'].mean())
print()
print('–ú–µ–¥–∏–∞–Ω–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É quantity:',order['quantity'].median())
print()
print('–ú–∏–Ω–∏–º—É–º –ø–æ —Å—Ç–æ–ª–±—Ü—É quantity:',order['quantity'].min())
print()
print('–ú–∞–∫—Å—Ç–∏–º—É–º –ø–æ —Å—Ç–æ–ª–±—Ü—É quantity:',order['quantity'].max())


# In[31]:


plt.figure(figsize=(10,7))
order['quantity'].hist(bins = 100, range = (1, 100))
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–∫–∞–∑–µ')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–∫–∞–∑–µ')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤');


# –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 1 —Ç–æ–≤–∞—Ä–∞. 
# 
# –ë—ã–ª–∏ –∏ —Ç–∞–∫–∏–µ –∑–∞–∫–∞–∑—ã, –≥–¥–µ –∫–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1000 —à—Ç.
# 
# –ü–æ –≥—Ä–∞—Ñ–∏–∫—É –≤–∏–¥–Ω–æ, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –∑–∞–∫–∞–∑–æ–≤ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 1-10 —Ç–æ–≤–∞—Ä–æ–≤.
# 
# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º. —á—Ç–æ –≤—Å–µ –∑–∞–∫–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Å—Ç–æ—è—Ç –±–æ–ª—å—à–µ, —á–µ–º –∏–∑ 10 —Ç–æ–≤–∞—Ä–æ–≤ - —ç—Ç–æ –∑–∞–∫–∞–∑—ã –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.
# 
# –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫—É—é –≤—ã—Ä—É—á–∫—É –ø—Ä–∏–Ω–æ—Å—è—Ç –º–∞–≥–∞–∑–∏–Ω—É —Ä–æ–∑–Ω–∏—á–Ω—ã–µ –∏ –æ–ø—Ç–æ–≤—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏

# In[32]:


#—Å–¥–µ–ª–∞–µ–º —Å—Ä–µ–∑—ã

retail = df_new.query('quantity <= 10 ')
commerce = df_new.query('quantity > 10 ')


# In[33]:


print('–í—ã—Ä—É—á–∫–∞ —Å —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π', retail['total'].sum())
print('–í—ã—Ä—É—á–∫–∞ —Å –æ–ø—Ç–æ–≤–∏–∫–æ–≤', commerce['total'].sum())


# –û–ø—Ç–æ–≤—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç –º–∞–≥–∞–∑–∏–Ω—É 29%

# In[34]:


#–ø–æ—Å–º–æ—Ç—Ä–∏–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É —Ä–æ–∑–Ω–∏—Ü—ã –∏ –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
retail_cat = retail.groupby('category')['quantity'].sum()
commerce_cat = commerce.groupby('category')['quantity'].sum()

#—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(10,7))
retail_cat.plot(kind = 'barh')
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —É —Ä–æ–∑–Ω–∏—Ü—ã')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show()


# In[35]:


#—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.figure(figsize=(10,7))
commerce_cat.plot(kind = 'barh')
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —É –æ–ø—Ç–æ–≤–∏–∫–æ–≤')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show()


# –†–æ–∑–Ω–∏—á–Ω—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–µ–µ –ø—Ä–æ—á–µ–≥–æ —Å–∫—É–ø–∞—é—Ç —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–¶–≤–µ—Ç—ã –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è" (3500 —à—Ç –ø—Ä–æ—Ç–∏–≤ 500 —É –æ–ø—Ç–æ–≤–∏–∫–æ–≤)
# 
# –£ –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –ª—é–∏–º—ã–µ —Ç–æ–≤–∞—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö "–•–æ–∑ —Ç–æ–≤–∞—Ä—ã" –∏ "–î–µ–∫–æ—Ä –∏ –∏–Ω—Ç–µ—Ä—å–µ—Ä"

# –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–∫–∞–∑–∞—Ö –æ–ø—Ç–æ–≤—ã—Ö –∏ —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

# In[36]:


retail_group = retail.groupby('month')['quantity'].sum()
#retail_group
plt.figure(figsize=(10,7))
retail_group.plot()
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º —É —Ä–æ–∑–Ω–∏—Ü—ã')
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show()


# In[37]:


commerce_group = commerce.groupby('month')['quantity'].sum()
#commerce_group
plt.figure(figsize=(10,7))
commerce_group.plot()
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º —É –æ–ø—Ç–æ–≤–∏–∫–æ–≤')
plt.xlabel('–ú–µ—Å—è—Ü')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show()


# –í –∑–∞–∫–∞–∑–∞—Ö —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –∏ –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å: –¥–æ –∏—é–Ω—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å—Ç—Ä–µ–º–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—Ç–µ—Ç (–ª—é–¥–∏ –≥–æ—Ç–æ–≤—è—Ç—Å—è –∫ –¥–∞—á–Ω–æ–º—É —Å–µ–∑–æ–Ω—É, –∫ —Ä–µ–º–æ–Ω—Ç–∞–º –∏ –ø—Ä), –∑–∞—Ç–µ–º —Å–ø—Ä–æ—Å —Ä–µ–∑–∫–æ –ø–∞–¥–∞–µ—Ç –∏ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∏–∑–∫–∏–º –¥–æ —Å–µ–Ω—Ç—è–±—Ä—è. –ó–∞—Ç–µ–º —Ä–æ—Å—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–µ–Ω—Ç—è–±—Ä—è-–æ–∫—Ç—è–±—Ä—è –∏ –æ–ø—è—Ç—å —Å–ø–∞–¥.
# 
# –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —É —Ä–æ–∑–Ω–∏—Ü—ã —Ä–æ—Å—Ç —Å–ø—Ä–æ—Å–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ (—Å –º–∞—Ä—Ç–∞), –Ω–æ –∏ –ø–∞–¥–µ–Ω–∏–µ —Ç–æ–∂–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞–Ω—å—à–µ (–≤ –∞–ø—Ä–µ–ª–µ).
# –£ –æ–ø—Ç–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: –±—É—Ä–Ω—ã–π —Ä–æ—Å—Ç - —Å –º–∞—è, –ø–∞–¥–µ–Ω–∏–µ –≤ –∏—é–Ω–µ.
# 

# –î–∞–ª–µ–µ –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ —Ä–æ–∑–Ω–∏—á–Ω—ã–º –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º (—Ç.–∫. –¥–æ–ª—è –∏—Ö –≤—ã—Ä—É—á–∫–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–æ–ª—è –æ–ø—Ç–æ–≤–∏–∫–æ–≤), —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∏ –¥–æ–ø –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç

# ### –°—Ä–µ–¥–Ω–∏–π —á–µ–∫, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –≤—ã—Ä—É—á–∫–∞ —É —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

# In[38]:


#–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫

chek_retail = retail.groupby('category')['total'].mean().sort_values()


plt.figure(figsize=(10,7))
chek_retail.plot(kind = 'barh')
plt.title('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —É —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π')
plt.xlabel('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show();


# In[39]:


#–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤

count_order_retail = retail.groupby('category')['order_id'].nunique().sort_values()


plt.figure(figsize=(10,7))
count_order_retail.plot(kind = 'barh')
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —É —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show();


# In[40]:


revenue_retail = retail.groupby('category')['total'].sum().reset_index().sort_values(by = 'total', ascending = False)

fig, ax = plt.subplots(figsize=(10,10))
ax.pie(revenue_retail['total'], labels=revenue1['category'], autopct='%1.1f%%');
ax.set_title('–î–æ–ª—è –≤—ã—Ä—É—á–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —É —Ä–æ–∑–Ω–∏—Ü—ã');


# –°–∏—Ç—É–∞—Ü–∏—è –ø–æ—á—Ç–∏ –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç–æ–π, —á—Ç–æ –º—ã –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –¥–æ –¥–µ–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –Ω–∞ —Ä–æ–∑–Ω–∏—Ü—É –∏ –æ–ø—Ç–æ–≤–∏–∫–æ–≤.
# 
# –ë–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –≤—ã—Ä—É—á–∫–∏ —É —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å —Ö–æ–∑ —Ç–æ–≤–∞—Ä–æ–≤ (56%). –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≤ –¥–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–∞–º–æ–µ –≤—ã—Å–æ–∫–æ–µ ~ 1200 —à—Ç. –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ 1300 —Ä—É–±.
# 
# –ï—â–µ –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∫–æ—Ç–æ—Ä–∞—è –¥–∞–µ—Ç –ø–æ—á—Ç–∏ 17% –≤—ã—Ä—É—á–∫–∏ - —ç—Ç–æ "–¶–≤–µ—Ç—ã –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è". –ó–∞–∫–∞–∑–æ–≤ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–∞–Ω–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –æ–∫–æ–ª–æ 800 —à—Ç—É–∫. –û–¥–Ω–∞–∫–æ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π (–æ–∫–æ–ª–æ 200 —Ä—É–±) –∑–∞ —Å—á–µ—Ç –Ω–∏–∑–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å–∞–º–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤. 

# ### –¢–æ–ø–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ —Å–∞–º—ã—Ö –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö (–æ—Å–Ω–æ–≤–Ω–æ–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç)

# In[41]:


#—Å–¥–µ–ª–∞–µ–º —Å—Ä–µ–∑ –ø–æ –¥–≤—É–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —É —Ä–æ–∑–Ω–∏—Ü—ã –∏ –Ω–∞–π–¥–µ–º —Ç–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç —á–∞—â–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö

flowers = retail.query('category == "–¶–≤–µ—Ç—ã –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è"')
household = retail.query('category == "–•–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã"')


# In[42]:


flowers['product'].value_counts().head(40)


# **–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–¶–≤–µ—Ç—ã –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è":**
#  - —Ä–∞—Å—Å–∞–¥–∞
#  - –ø–µ–ª–∞—Ä–≥–æ–Ω–∏—è
#  - —Ç–æ–º–∞—Ç
#  - –≥–µ—Ä–∞–Ω—å –¥–æ–º–∞—à–Ω—è—è
#  

# In[43]:


household['product'].value_counts().head(40)


# **–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–•–æ–∑ —Ç–æ–≤–∞—Ä—ã":**
#  - —Å—É—à–∏–ª–∫–∞
#  - —Å—É–º–∫–∞-—Ç–µ–ª–µ–∂–∫–∞ 
#  - –≥–ª–∞–¥–∏–ª—å–Ω–∞—è –¥–æ—Å–∫–∞

# ## –†–∞–±–æ—Ç–∞ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏

# –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ  —Å—Ç–æ–ª–±—Ü–∞—Ö –æ–±—â–µ–π —Ç–∞–±–ª–∏—Ü—ã

# In[44]:


df_new.describe()


# –í–∏–¥–Ω–æ, —á—Ç–æ –≤ —Å—Ç–æ–ª–±—Ü–µ total —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ: –∑–Ω–∞—á–∏—Ç  –≤ —Å—É–º–º–∞—Ä–Ω–æ–π –≤—ã—Ä—É—á–∫–µ –µ—Å—Ç—å —Å–∏–ª—å–Ω—ã–µ –≤—ã–±—Ä–æ—Å—ã. 
# 
# –û—Ç –Ω–∏—Ö –Ω—É–∂–Ω–æ –∏–∑–±–∞–≤–∏—Ç—å—Å—è.

# In[45]:


data = df_new['total'].reset_index()

data.boxplot()
plt.ylim(0,1700);


# –í —Å—Ç–æ–ª–±—Ü–µ —Å —Å—É–º–º–∞—Ä–Ω–æ–π –≤—ã—Ä—É—á–∫–æ–π –≤—ã–±—Ä–æ—Å–∞–º–∏ —Å—á–∏—Ç–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—à–µ 1650 —Ä—É–±

# In[46]:


#–¥–µ–ª–∞–µ–º –Ω–æ–≤—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –ë–ï–ó –≤—ã–±—Ä–æ—Å–æ–≤

data_new =df_new[df_new['total'] <= 1650]
data_new


# In[47]:


data_new.describe()


# –¢–µ–ø–µ—Ä—å —Å—Ç–∞–Ω–¥—Ä–∞—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–µ—Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ.

# ## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑

# ### –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ –ø–æ —Ä–æ–∑–Ω–∏—á–Ω—ã–º –∏ –æ–ø—Ç–æ–≤—ã–º –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è

# –§–æ—Ä–º—É–ª–∏—Ä—É–µ–º H0: "–°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ —Å –∑–∞–∫–∞–∑–æ–≤ –∏–∑ —Ä–æ–∑–Ω–∏—Ü—ã –∏ –æ–ø—Ç–∞ —Ä–∞–≤–Ω—ã"
# 
# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è H1: "–°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞ —Å –∑–∞–∫–∞–∑–æ–≤ –∏–∑ —Ä–æ–∑–Ω–∏—Ü—ã –∏ –æ–ø—Ç–∞ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è"

# In[48]:


#–¥–µ–ª–∞–µ–º –Ω–æ–≤—ã–µ —Å—Ä–µ–∑—ã –ø–æ –æ–ø—Ç–æ–≤—ã–º –∏ —Ä–æ–∑–Ω–∏—á–Ω—ã–º –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º

retail2 = data_new.query('quantity <= 10 ')
commerce2 = data_new.query('quantity > 10 ')


# In[49]:


#–≤—ã–≤–µ–¥–µ–º —Å—É–º–º–∞—Ä–Ω—É—é –≤—ã—Ä—á–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É –≤ —Ä–æ–∑–Ω–∏—Ü–µ –∏ –≤ –æ–ø—Ç–µ
profit_retail = retail2.groupby('order_id')['total'].sum().reset_index()
profit_commerce = commerce2.groupby('order_id')['total'].sum().reset_index()


# In[50]:


alpha = .05


# In[51]:


results = st.ttest_ind(profit_retail['total'], profit_commerce['total'], equal_var = False)


# In[52]:


print('p-–∑–Ω–∞—á–µ–Ω–∏–µ:', results.pvalue)

if results.pvalue < alpha:
    print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É')
else:
    print('–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É')


# In[53]:


#–¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Ç–µ—Å—Ç —Å—Ä–∞–±–æ—Ç–∞–ª –≤–µ—Ä–Ω–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ—Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω—é—é –≤—ã—Ä—É—á–∫—É –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º –∏–∑ —Ä–æ–∑–Ω–∏—Ü—ã –∏ –æ–ø—Ç–∞
print(profit_retail['total'].mean())
print(profit_commerce['total'].mean())


# –í—ã–≤–æ–¥: –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, —Å—Ä–µ–¥–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ —Å –∑–∞–∫–∞–∑–æ–≤ –æ–ø—Ç–æ–≤—ã—Ö –∏ —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã (—Å—Ä —á–µ–∫ –ø–æ –æ–ø—Ç–æ–≤–∏–∫–∞–º –±–æ–ª—å—à–µ –Ω–∞ 38%)

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ì–∏–ø–æ—Ç–µ–∑—ã —Å—Ñ–æ—Ä—É–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
# </div>

# ## –í—ã–≤–æ–¥

# –ë–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏ –º–∞–≥–∞–∑–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç —Å —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (71%). 
# 
# –°–∞–º—ã–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —É —Ç–∞–∫–∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —Å—Ç–∞–ª–∏ "–•–æ–∑ —Ç–æ–≤–∞—Ä—ã": –Ω–∞ –Ω–∏—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –æ–∫–æ–ª–æ 1200 –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ 56 % –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏ –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ –≤ —Ä–æ–∑–Ω–∏—Ü–µ; –∏ "–¶–≤–µ—Ç—ã –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è": –ø–æ—á—Ç–∏ 17% –≤—ã—Ä—É—á–∫–∏ –∏ ~800 –∑–∞–∫–∞–∑–æ–≤.
# 
# –ò–º–µ–Ω–Ω–æ –≤ —ç—Ç–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ç–æ–≤–∞—Ä—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞: –∏—Ö –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç —á–∞—â–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.
# 
# –õ–∏–¥–µ—Ä–∞–º–∏ –ø–æ –ø—Ä–æ–¥–∞–∂–µ –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö —Å—Ç–∞–ª–∏:
#  - —Å—É—à–∏–ª–∫–∞
#  - —Å—É–º–∫–∞-—Ç–µ–ª–µ–∂–∫–∞
#  - –≥–ª–∞–¥–∏–ª—å–Ω–∞—è –¥–æ—Å–∫–∞
#  - —Ä–∞—Å—Å–∞–¥–∞
#  - –ø–µ–ª–∞—Ä–≥–æ–Ω–∏—è
#  - —Ç–æ–º–∞—Ç
#  - –≥–µ—Ä–∞–Ω—å –¥–æ–º–∞—à–Ω—è—è
#  
# –í –∑–∞–∫–∞–∑–∞–∑ —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö –∏ –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å: –¥–æ –∏—é–Ω—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å—Ç—Ä–µ–º–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—Ç–µ—Ç (–ª—é–¥–∏ –≥–æ—Ç–æ–≤—è—Ç—Å—è –∫ –¥–∞—á–Ω–æ–º—É —Å–µ–∑–æ–Ω–Ω—É, –∫ —Ä–µ–º–æ–Ω—Ç–∞–º –∏ –ø—Ä), –∑–∞—Ç–µ–º —Å–ø—Ä–æ—Å —Ä–µ–∑–∫–æ –ø–∞–¥–∞–µ—Ç –∏ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∏–∑–∫–∏–º –¥–æ —Å–µ–Ω—Ç—è–±—Ä—è. –ó–∞—Ç–µ–º —Ä–æ—Å—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–µ–Ω—Ç—è–±—Ä—è-–æ–∫—Ç—è–±—Ä—è –∏ –æ–ø—è—Ç—å —Å–ø–∞–¥.
# 
# 
# –°—Ä–µ–¥–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –ø–æ –∑–∞–∫–∞–∑–∞–º –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–æ–∑–Ω–∏—Ü—ã –∏ –æ–ø—Ç–∞ —Ä–∞–∑–Ω—è—Ç—Å—è (670 –∏ 927 —Ä—É–±).

# <div class="alert alert-success">
# <b>üëç –£—Å–ø–µ—Ö:</b> –ü–æ–ª—É—á–∏–ª—Å—è —Ö–æ—Ä–æ—à–∏–π –ø—Ä–æ–µ–∫—Ç, –º–æ–ª–æ–¥–µ—Ü! –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø —Ä–∞–±–æ—Ç—ã, –æ—Ç —ç—Ç–æ–≥–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞. –í —Ä–∞–±–æ—Ç–µ –±—ã–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –≤–∞–∂–Ω—ã–µ –ø—É–Ω–∫—Ç—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö–æ—Ä–æ—à–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏, –µ—Å—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∏—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥
# </div>

# In[ ]:




